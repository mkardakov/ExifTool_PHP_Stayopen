{"name":"Exiftool PHP Stayopen Batch Processor","tagline":"PHP ultra-fast library to allow accessing the excellent ExifTool (http://www.sno.phy.queensu.ca/~phil/exiftool/) metadata manipulation tool on single files or on batches.","body":"ExifTool_PHP_Stayopen\r\n=====================\r\n\r\nIve created a script that can be used to run ExifTool in StayOpen mode within PHP.\r\nThe script can be inited as a singleton or instance.\r\nIve also supplied two additional scripts that wrap the class ready for use with gearman for scaleout.\r\nThe class does not apply any logic to the parameters supplied to ExifTool, what you push though gets passed though and the result is then returned.\r\nThe class detects if ExifTool has died and restarts it on the next call.\r\n\r\nIt still has some work to do and cleaning up but seems to work well in my environment and scales out quite nicely.\r\nOriginally I was using PHP streams but this proved to be a problem so instead using fgets to parse the return.\r\nNote that script is hard coded to work with 9.03+ of ExifTool only because this is all I have been testing against since.\r\n\r\nLet me know what you think or any changes to make it better.\r\n\r\nPhil Harvey's Exiftool  - http://www.sno.phy.queensu.ca/~phil/exiftool/\r\n\r\nPhil Harvey's Exiftool  (Forum Dev Post) - http://u88.n24.queensu.ca/exiftool/forum/index.php/topic,5381.0.html\r\n\r\nPerformance tests\r\n-\r\nThese figures are to be taken as a guide of performance increase possible with supplied scripts but will vary depending on your hardware setup and arguments supplied to ExifTool (test system was running on ESXi/Opteron 2435/4vCPU/2G)\r\n\r\n100 iterations fetching metadata from a JPEG (-use MWG -g -j -all:all)<br/>\r\n1 GM Instance - 1.3s<br/>\r\n2 GM Instances - 0.9s<br/>\r\n3 GM Instances - 0.7s<br/>\r\n4 GM Instances - 0.6s<br/>\r\n\r\n300 iterations with 4 GM Instances - 1.6s<br/>\r\n100 iterations 3 files on each iteration with 4 GM Instances - 1.4s<br/>\r\n50 iterations 6 files on each iteration with 4 GM Instances - 1.1s<br/>\r\n100 iterations 10 files on each iteration with 4 GM Instances - 3.1s<br/>\r\n\r\nUsage\r\n-\r\nBelow is a basic example on how to use this class.\r\nPut all your commands in an array and push it into the stack using the `$exif->add()` function, you can add multiple jobs to process before calling `fetch()`/`fetchAll()`.\r\n\r\n`getInstance()` setup class as a singleton<br/>\r\n`setExifToolPath($path)` set/change the path of ExifTool if not supplied at start<br/>\r\n`setIdleTimeout($timeout)` idle seconds until ExifTool process is terminated<br/> \r\n`setProcessTimeout($timeout)` total ExifTool running seconds until process is terminated<br/>\r\n`close()` terminate ExifTool background process<br/>\r\n`start()` start ExifTool background process<br/>\r\n`test()` to check if ExifTool is running.<br/>\r\n`clear()` clear the stack<br/>\r\n`fetch()` will return one processed item off the stack at a time.<br/>\r\n`fetchAll()` will return a single array with all items in the stack processed.<br/>\r\n`fetchDecoded($assoc)` will return one processed item off the stack at a time with JSON output decoded.<br/>\r\n`fetchAllDecoded($assoc)` will return a single array with all items in the stack processed and JSON output decoded.<br/>\r\n`fetchCallback($callback)` will return one processed item via user callback off the stack at a time .<br/>\r\n`fetchAllCallback($callback)` will return a single array with all items in the stack processed after processing via user callback.<br/>\r\n`getError($id)` will return FALSE or STDERR output if there was an error, pass index if `fetchAll()` was used<br/>\r\n`getErrorStr($id)` will return STDERR output, pass index if `fetchAll()` was used<br/>\r\n`getSummary(msg)` will return summary value from msg passed which are defined as const's<br/>\r\n\r\nAs you fetch items they are taken off the stack.\r\n\r\nExamples\r\n---\r\nSimple request to get all image metadata\r\n```php\r\n$data=array('-*:*','test1.jpg');\r\n$exif = ExifToolBatch::getInstance(/path/to/exiftool');\r\n$exif->add($data);\r\n$result=$exif->fetchAll();\r\n```\r\n","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}